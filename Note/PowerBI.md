# Power BI 上課筆記

資料資源：

- [用 Microsoft Power BI 做大數據分析](https://www.youtube.com/watch?v=fEP5yqaRDEc) - 孫在陽
- [Power BI數據分析實戰-邏輯與資料視覺化](https://hahow.in/courses/5aced6bad21aee001e55e63a/assignments?item=5b481cecdf9c8d001ed24df1&panelMode=PLAY_LIST) - Dax
- [Power BI 資料分析與視覺化實戰溝通術](https://mastertalks.thinkific.com/courses/take/PowerBI/lessons/4812304)
- [Power BI 文件](https://docs.microsoft.com/zh-tw/power-bi/) - Microsoft
- 網友技術分享

使用版本為2.69，不同版本的介面可能會不太一致。

## 簡介

Power BI是一個關於報表的免費工具，只有後續的服務可能需要收費，下載網址：<https://powerbi.microsoft.com/zh-tw/downloads/>

對大部分的使用者(設計報表的)而言，下載「Microsoft Power BI Desktop」就可以了，Mobile則是針對手機端的取用者，Pro和Premium則是雲端服務的部分([定價參考](https://powerbi.microsoft.com/zh-tw/pricing/))，而報表伺服器則是提供給本地的報表分享方案，就不多說明了。

接下來的安裝過程，基本上是下一步到底(除非有特別需求)，可以趁安裝註冊Power BI的使用帳號，以使用後續的發佈(publish)，但是需用公司或付費信箱進行註冊及登入，如果有Office365的使用權，就可以直接登入。

### 基本畫面

上方列頁籤

- 檔案(最左邊的圖示)：新增、儲存、匯出入、設定、說明等
- 常用：bj4，從剪貼簿、取得資料(外部或自行輸入)、插入
- 檢視表：可切換一般預覽或手機配置。還提供貼騎格線(強迫症救星)和一些小窗的開合
- 模型：管理關聯性、新增資料或量值、排序、格式化、屬性、安全性、群組等，資料相關功能。
- 說明：PowerBI的說明、社群資源等
- 其他：隨著選擇的圖表或功能不同，會有額外頁籤

下方則是隨著切換至「報告、資料、模型」，會有不一樣的呈現。

- 報告：也能說是儀表板(Dashboard)，主要顯示圖表的地方，右側設定的部分有提供快速建立圖表的「視覺效果」、設定各欄位呈現的「欄位配置」、列出資料來源有哪些的Table與Column的「欄位」。

### 匯入資料

Power BI支援多種匯入資料的方法，有多種資料庫連線、EXCEL、自行輸入等。

### 發行 或 分享
Power BI Desktop
- 發行至Web Service
- 匯出成PDF
- 輸出靜態簡報
- 輸出動態簡報(PowerPoint 2013以上的版本，並在增益集新增)

Power BI Service
- 以HyperLink在網路上分享
- 手機使用APP進行存取
- 在支援iframe的網站放上HTML片段


## Power View
本單元著重在圖表呈現及分析心法

### U17 下載與使用自定義圖表

除了 Power BI Desktop 預先提供的視覺效果(圖表)外，也可以新增更多圖表。不過自定義(客製化)圖表有哪些選項是由圖表開發者決定，所以選項通常會比較少。

#### 從Marketplace取得視覺效果

1. 點選主頁面右側「視覺效果」中的「...」
2. 選擇「從Marketplace匯入」
3. 搜尋要用的視覺效果
4. 點「新增」

#### 從網路上下載視覺效果
1. 搜尋「power bi visuals」或直接前往[marketplace](https://appsource.microsoft.com/en-us/marketplace/apps?product=power-bi-visuals)
2. 找到要用的圖表點「GET IT NOW」下載
3. 再回到Power BI Desktop
4. 點選主頁面右側「視覺效果」中的「...」
5. 從檔案匯入
6. 選擇剛才下載的檔案

### 動態視覺化圖表

(無感想)

### 分組依據(資料聚合) & 樞紐分析

比起在Power Query處理，在Power View 中處理更具有彈性
而「分組依據」 = Group By，可以簡化資料資料的維度(如將「時」群聚為「天」)
「樞紐分析」= 將長表格轉換成寬表格(常見的報表形式)或圖表

## Power Query
本單元著重在資料獲取及資料清洗

### 資料結構
結構化：有定義欄位的資料(ex. 經過正規化的Excel、Database)
半結構化：JSON、XML
非結構化：影像、圖片、聲音、網頁內容。(這種需要先結構化才能近一步使用)

### 資料清理

被清理乾淨的資料，需具有以下特性 (僅供參考)

- 每一個變數構成一欄
- 每一個觀察值構成一列
- 每一張表只包含一種觀察單位

取用外部資料時，需要進一步處理才方便運用

- 刪除重複出現的值
- 分割資料欄位內的資料(如以底線在一個欄位內標是兩種值或代碼)
- 排除不需要的資料，只擷取有意義的值
- 將NULL或特殊符號，替換成可分析的值 ( 0, 或 負數)
- 指定欄位的data type，避免計算時無法使用
- 新增索引值 (新增索引資料行)
- 將資料進行分群 (新增條件資料行)
- 對數值進行加工 (取餘數、取LOG、進位方式等，詳見「轉換 → 數字資料行」)
- 對日期進行加工 (轉換成年度、季度、每月第幾週等，詳見「轉換 → 日期與時間資料行」)

### 將寬表格轉至為長表格
寬表格：每一列包含多個觀察值，可以一次看到大量資訊，但是PowerBI較不易進行視覺化 (Report)
長表格：每一列只包含一個觀察值 (List)，符合理想的乾淨資料

視情況刪除不需要的欄位，還有設定標頭(thead)

1. 將左側合併成1維 (ex「X」「Y」 => 「X_Y」)
2. 轉置表格( 轉換 → 表格 → 轉置)
3. 填補缺漏值
4. 取消欄位的樞紐分析 (ex. 國家、行業別)
5. 分割首欄的資料

1x1表格： 步驟4
1x2表格： 步驟2→3→4
2x2表格： 步驟3→1→2→3→4→5

如果結合其他語言，可以進一步處理堆疊表格

### 合併表格
有時需要橫向(Left Join, Right Join, Inner Join, Cross Join)或縱向(同樣的欄位但不同Table)合併表格，可以在Power Query中使用「檔案→合併」。兩者如果遇到不存在的欄位會帶入NULL。

橫向合併：合併查詢。要以多個欄位進行合併時，可按住Ctrl 多選。
還能用縱向合併：附加查詢。可以同時合併多個Table。

### 資料的三角驗證(重要性 & 品質)
透過「不同的資料來源、業務規則、領域專業知識」，確認誤差值是否在容許範圍內(1~5%內)

觀光：人數可以參考兩國的資料(一進一出)。
電商：出貨量與進貨量的關係、財務收據與銷售額是否一致
訂單：標價是否遠高/低於市價

## 圖表

### 散佈圖

> 用非數學的方式來辨認某現象的測量值與可能原因因素之間的關係
> 繪製散佈圖的數據必須是成對的(X,Y)
> 通常用垂直軸表示現象測量值Y , 用水平軸表示可能有關係的原因因素X
>
> ~ ref. [散佈圖- MBA智库百科](https://wiki.mbalib.com/zh-tw/%E6%95%A3%E5%B8%83%E5%9B%BE)

d45